# yamllint disable rule:line-length
# SPDX-FileNotice: üÖ≠üÑç1.0 This file is dedicated to the public domain using the CC0 1.0 Universal Public Domain Dedication <https://creativecommons.org/publicdomain/zero/1.0/>.
# SPDX-FileContributor: Jason Yundt <jason@jasonyundt.email> (2021‚Äì2023)
# yamllint enable


%YAML 1.2
---
# Rationale: CC0-1.0.txt contains the official plain text version of CC0 [1].
# From a copyright perspective, it‚Äôs OK to modify CC0‚Äôt text [2]. The caveat is
# that CC0 contains trademarks that are owned by Creative Commons [3]. Creative
# Commons does give us a license to use those trademarks, but that license
# stipulates that you can‚Äôt use those trademarks with modified versions of
# Creative Commons legal tools. CC0 is a Creative Commons legal tool [4], so if
# we modify CC0, then we have to remove any Creative Commons trademarks from it.
#
# Excluding CC0-1.0.txt makes sure that pre-commit won‚Äôt inadvertently encourage
# someone to modify CC0‚Äôs text. In general, legal text should be handled with
# care and not automatically modified by a tool.
#
# I‚Äôm also excluding CC0-1.0.txt.spdx-meta since it would be annoying to make
# that file and CC0-1.0.txt pass the assert_contains_regex hook.
#
# yamllint disable rule:line-length
# [1]: <https://wiki.creativecommons.org/wiki/CC0_FAQ#May_I_apply_CC0_to_computer_software.3F_If_so.2C_is_there_a_recommended_implementation.3F>
# [2]: <https://github.com/creativecommons/creativecommons.org/issues/1218#issuecomment-1212525987>
# [3]: <https://creativecommons.org/policies/#trademark>
# [4]: <https://creativecommons.org/faq/#what-is-creative-commons-and-what-do-you-do>
exclude: "^CC0-1\\.0\\.txt(\\.spdx-meta)?$|^LICENSES\\/.*"
repos:
    -
        repo: https://gitlab.com/vojko.pribudic/pre-commit-update
        rev: v0.1.0
        hooks:
            -
                id: pre-commit-update
                args: [--dry-run]
    -
        repo: https://github.com/pre-commit/pre-commit-hooks
        rev: v4.5.0
        hooks:
            - id: check-yaml
            - id: check-case-conflict
            - id: check-executables-have-shebangs
            - id: check-merge-conflict
            - id: check-symlinks
            - id: check-toml
            - id: check-vcs-permalinks
            - id: check-shebang-scripts-are-executable
            - id: destroyed-symlinks
            - id: detect-private-key
            - id: end-of-file-fixer
            -
                # Rationale: I‚Äôm going to be deploying to Unix-like systems, so
                # it‚Äôs better to use Unix-style line endings.
                id: mixed-line-ending
                args: ["--fix=lf"]
            - id: trailing-whitespace
    -
        repo: https://github.com/jumanjihouse/pre-commit-hooks
        rev: 3.0.0
        hooks:
            -
                id: forbid-space-in-indent
                # YAML requires spaces for indentation. See:
                # <https://yaml.org/spec/1.2.2/#61-indentation-spaces>
                # Pipfile.lock is automatically generated.
                # knot.conf uses YAML-like syntax. See:
                # <https://www.knot-dns.cz/docs/3.2/html/configuration.html>
                exclude: '.*\.yaml$|(.*/)?Pipfile\.lock$|imports/knot-dns/knot\.conf$'
                # This is a workaround the following issue:
                # <https://github.com/jumanjihouse/pre-commit-hooks/issues/69>
                types: ['text']
    -
        repo: https://github.com/adrienverge/yamllint
        rev: v1.33.0
        hooks:
            - id: yamllint
    -
        repo: https://github.com/igorshubovych/markdownlint-cli
        rev: v0.38.0
        hooks:
            - id: markdownlint
    -
        repo: https://github.com/scop/pre-commit-shfmt
        rev: v3.7.0-4
        hooks:
            -
                id: shfmt-src
                args: ["-fn"]
    -
        repo: https://github.com/pre-commit/mirrors-mypy
        rev: v1.8.0
        hooks:
            -
                id: mypy
                additional_dependencies: &usn_deps [dnspython]
    -
        repo: https://github.com/PyCQA/autoflake
        rev: v2.2.1
        hooks:
            - id: autoflake
    -
        repo: local
        hooks:
            #-
            #    id: &usn update-serial-numbers
            #    name: *usn
            #    # Here‚Äôs how I decided what to set the language and
            #    # entry to:
            #    # <https://pre-commit.com/#repository-local-hooks>
            #    entry: python local-pre-commit-hooks/update-serial-numbers.py
            #    additional_dependencies: *usn_deps
            #    language: python
            #    files: &zone_files ".*\\.zone$"
            #    always_run: true
            #    description: Update serial numbers in DNS zone file SOA records
            #    stages:
            #        - post-commit
            -
                id: &kzc kzonecheck
                name: *kzc
                entry: ./local-pre-commit-hooks/kzonecheck.sh
                language: system
                files: &zone_files ".*\\.zone$"
                description: Validate DNS zone files
            -
                id: &ckc check-knot.conf
                name: *ckc
                entry: ./local-pre-commit-hooks/check-knot.conf.sh
                language: system
                files: '(^|.*/)knot\.conf$'
                description: Validate Knot DNS config files
# TODO: How do I make it accept hard tabs?
#    -
#        repo: https://github.com/nix-community/nixpkgs-fmt
#        rev: v1.2.0
#        hooks:
#            - id: nixpkgs-fmt
    -
        repo: https://pagure.io/assert_contains_regex.git
        rev: 0.0.0
        hooks:
            -
                id: assert_contains_regex
                args:
                    - --companion-suffix
                    - .spdx-meta
                    - --pattern
                    - >
                        SPDX-FileNotice:( üÖ≠üÑç1\.0 (Unless otherwise noted,
                        everything in t|T)his file is dedicated to the
                        public domain using the CC0 1\.0 Universal Public
                        Domain Dedication
                        <https://creativecommons.org/publicdomain/zero/1\.0/>|
                        The author of this font waived all copyright to the
                        font and released it into the üÖÆ public
                        domain).|SPDX-License-Identifier:( LicenseRef-MIT-JY|
                        LicenseRef-MIT-NixOSWiki)
                    - --pattern
                    - >
                        SPDX-FileContributor:
                        .+( <.+>)?
                        \(([0-9]{4}[-‚Äì])?[0-9]{4}\)|SPDX-FileCopyrightText:(
                        ([0-9]{4}[-‚Äì])?[0-9]{4}
                        .+ <.+>)
